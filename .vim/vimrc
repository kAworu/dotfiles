runtime bundle/vim-pathogen/autoload/pathogen.vim
execute pathogen#infect()
set nocompatible

set path=.,./include,/usr/include,/usr/local/include,,
set pastetoggle=<F10>
let mapleader = "\<space>"
set sm

set complete=.,w,b,u,t,i

set nomodeline
set modelines=0

set backspace=indent,eol,start

set title
set shortmess=aoOtTI
set wildmenu
set wildmode=longest:full,full

set viminfo='20,\"500,h
set history=50

set fileencodings=utf-8,latin1,default
set fileformats=unix

set shiftwidth=4
set tabstop=4
set expandtab
set smarttab
set autoindent
set preserveindent
set smartindent

let showbreak="> "
set list
if (&termencoding ==# 'utf-8' || &encoding ==# 'utf-8') && version >= 700
  let &listchars="tab:←-,trail:•,extends:⇉,precedes:⇇,nbsp:␣"
else
  set listchars=tab:>-,trail:~,extends:>,precedes:<,nbsp:_
endif

set selection=inclusive
set virtualedit=block

set number
set numberwidth=3
set cursorline
set ruler
set showcmd

set hlsearch
set incsearch

set scrolloff=3
set sidescrolloff=5
set scrolljump=1

set foldcolumn=2
set foldmethod=marker

set completeopt=longest,menu,preview

set diffopt+=vertical

set timeoutlen=250

set shell=/bin/sh
set grepprg=grep\ -nH\ $*

" english spell check by default (:set spell)
setlocal spelllang=en

" split navigation
map <Tab> <C-w>w
map <S-Tab> <C-w>W
" quickfix navigation
nmap <C-n> :cnext<return>
nmap <C-p> :cprev<return>
nmap <C-o> :copen<return>

if has("autocmd")
    filetype plugin indent on

    autocmd FileType text setlocal textwidth=78
    autocmd FileType c      set omnifunc=ccomplete#Complete
    autocmd FileType css    set omnifunc=csscomplete#CompleteCSS
    autocmd FileType html   set omnifunc=htmlcomplete#CompleteTags
    autocmd FileType man    set nolist
    autocmd FileType php    set omnifunc=phpcomplete#CompletePHP
    autocmd FileType python set omnifunc=pythoncomplete#Complete
    autocmd FileType ruby   set omnifunc=rubycomplete#Complete
    autocmd FileType sql    set omnifunc=sqlcomplete#Complete
    autocmd FileType xml    set omnifunc=xmlcomplete#CompleteTags
    " When editing a file, always jump to the last known cursor position.
    " Don't do it when the position is invalid or when inside an event handler
    " (happens when dropping a file on gvim).
    autocmd BufReadPost *
                \ if line("'\"") > 0 && line("'\"") <= line("$") |
                \   execute "normal! g`\"" |
                \ endif
    " When editing a new file, load skeleton if any.
    " If we find <+FILENAME+> replace it by the filename.
    " If we find <+HEADERNAME+> replace it by the filename uppercase with .
    "       replaced by _ (foo.h become FOO_H).
    " If we find <+CLASSNAME+> replace it by the filename without the extensions.
    autocmd BufNewFile *
                \ let skel = $HOME . "/.vim/skeletons/skel." . expand("%:e") |
                \ if filereadable(skel) |
                \   execute "silent! 0read " . skel |
                \   let fn = expand("%") |
                \   let hn = substitute(expand("%"), "\\w", "\\u\\0", "g") |
                \   let hn = substitute(hn, "\\.", "_", "g") |
                \   let hn = substitute(hn, "/", "_", "g") |
                \   let cn = expand("%:t:r") |
                \   %s/<+FILENAME+>/\=fn/Ige |
                \   %s/<+HEADERNAME+>/\=hn/Ige |
                \   %s/<+CLASSNAME+>/\=cn/Ige |
                \   unlet fn hn cn |
                \ endif |
                \ unlet skel |
                \ goto 1
endif " has autocmd

" skeleton template use <+KEY+>
nnoremap § <esc>/<+.\{-1,}+><return>c/+>/e<return>
inoremap § <esc>/<+.\{-1,}+><return>c/+>/e<return>

set background=dark
syntax enable
if &background == "dark"
    " fancy color stuff
    " onedark.vim override: Don't set a background color when running in a terminal;
    " just use the terminal's background color
    " `gui` is the hex color code used in GUI mode/nvim true-color mode
    " `cterm` is the color code used in 256-color mode
    " `cterm16` is the color code used in 16-color mode
    if (has("autocmd") && !has("gui_running"))
      let s:white = { "gui": "#ABB2BF", "cterm": "145", "cterm16" : "7" }
      autocmd ColorScheme * call onedark#set_highlight("Normal", { "fg": s:white }) " No `bg` setting
    end

    " override comments, tabs/spaces, and lines numbers to lighter grays than the
    " default.
    let g:onedark_color_overrides = {
               \ "comment_grey":   {"gui": "#808080", "cterm": "244", "cterm16": "15" },
               \ "special_grey":   {"gui": "#6c6c6c", "cterm": "242", "cterm16": "15" },
               \ "gutter_fg_grey": {"gui": "#6c6c6c", "cterm": "242", "cterm16": "15" } }
    colorscheme onedark
    let s:colorscheme = 'onedark'
else
    set t_Co=256
    colorscheme PaperColor
    let s:colorscheme = 'PaperColor'
endif

"lightline config
set laststatus=2
let g:lightline = {
    \ 'colorscheme': s:colorscheme,
    \ 'active': {
    \   'right': [ [ 'lineinfo' ],
    \              [ 'percent' ],
    \              [ 'fileformat', 'fileencoding', 'filetype', 'charvaluehex' ] ]
    \ },
    \ 'component': {
    \   'charvaluehex': '0x%B'
    \ },
    \ }

" use XHTML and CSS with :TOhtml
let use_xhtml=1
let html_use_css=1
let html_ignore_folding=1
let html_use_encoding="UTF-8"

" Java
let java_highlight_all=1
let java_allow_cpp_keywords=1

" Python
let python_highlight_builtins=1
let python_highlight_exceptions=1
let python_highlight_numbers=1
let python_highlight_space_errors=1

" Ruby
let ruby_operators=1
let g:rubycomplete_buffer_loading=1
let g:rubycomplete_classes_in_global=1

" syntastic
let g:syntastic_enable_signs = 1
let g:syntastic_auto_loc_list = 1

" gist
let g:gist_detect_filetype = 1
let g:gist_show_privates = 1

" mail
au BufRead ~/.tmp/mutt* set textwidth=72

" fugitive
nmap <C-k> :Ggrep 
vnoremap <C-k> y/<C-r>"<return>:silent Ggrep <C-r>0<return>:copen<return>:redraw!<return>

" NERDTree
"Show hidden files
let NERDTreeShowHidden=1
" combine NERDTreeFind with NERDTreeToggle,
" see https://stackoverflow.com/a/33465522
nmap <F2> :NERDTreeToggle %<return>

" external command paths
let uname = substitute(system('uname'), "\n", "", "")
if uname == "OpenBSD"
    let Tlist_Ctags_Cmd = "/usr/local/bin/ectags"
elseif uname == "Darwin"
    let Tlist_Ctags_Cmd = "/usr/local/bin/ctags"
endif
" vim:ft=vim:sw=2:ts=2:et
